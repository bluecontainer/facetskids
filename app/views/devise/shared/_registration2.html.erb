<% content_for :title, "Sign Up" %>

<script>
  function Ctrl($scope) {
    $scope.plan = "<%= resource.plan %>";
  }
</script>

<div ng-app ng-controller="Ctrl">

<!--div class="row">
  <div class="col-md-offset-1 col-md-7">
    <div ng-show="plan == 'alpha'">
    <p>Sign up now to create an account and become a pioneer.</p>
    </div>
    <div ng-show="plan == 'silver'">
    <p>Help us build the app and inspire the creators of tomorrow.</p>
    </div>
  </div>
</div-->

<div class="row">
  <div class="col-md-offset-3 col-md-6">
    <div id="stripe_error" class="alert alert-error" style="display:none" >
    </div>
  </div>
</div>

<%= content_for(:the_links) do %>
  I have read and agree to the Privacy Policy
<% end %>

<div class="row">
  <div class="col-md-offset-1 col-md-11">

<%= simple_form_for(resource, :as => resource_name, :url => @path, :html => {:class => 'card_form', :method => @method }) do |f| %>

    <div class="row">
      <div class="col-md-4">
  <%= f.input :plan, as: :radio_buttons, label: false, collection: [ ["alpha","Free alpha account"], ["silver","Contribute $50 or more (one year subscription)"], ["red","$6 per month"] ], label_method: :last, value_method: :first, input_html: { "ng-model" => "plan", :data => {:toggle => 'radio'} } %>
      </div>
      <div class="col-md-offset-1 col-md-4">
        <div ng-show="plan == 'alpha'">
          <p>Sign up now to create an account and become a pioneer.</p>
        </div>
        <div ng-show="plan == 'silver'">
          <p>Help us build the app and inspire the creators of tomorrow.</p>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
  <%= f.error_notification %>
  <%= display_base_errors resource %>
      </div>
    </div>

  <%= f.hidden_field :invitation_token, :value => resource.invitation_token unless resource.invitation_token.nil? %>

    <div class="row">
      <div class="col-md-4">
        <% if resource.invitation_token.nil? %>
        <%= f.input :email, :required => true, :placeholder => "Email", :autofocus => true %>
        <% else %>
        <%= f.input :email, :required => true, :placeholder => "Email", :readonly => true %>
        <% end %>
        <%= f.input :password, :required => true, :placeholder => "Password" %>
        <%= f.input :password_confirmation, :required => true, :placeholder => "Password again" %>
        <%= f.input :child_age, :required => true, :label => "Child's Age", :placeholder => "Child's age", collection: 2..15 %>
      </div>
      <div class="col-md-offset-1 col-md-5">
        <span ng-show="plan == 'silver'">
          <%= f.input :donation_amt, :label => "Donation Amount", :placeholder => "Donation", collection: (50..1000).step(10), input_html: { class: "select-block mbl"} %>
        </span>
        <span ng-show="plan == 'silver' || plan == 'red'">
          <%= f.input :name %>
          <div class="field">
            <%= label_tag :card_number, "Credit Card Number" %>
            <%= text_field_tag :card_number, nil, {name: nil, class: "form-control"} %>
          </div>
          <div class="field">
            <%= label_tag :card_code, "Card Security Code (CVV)" %>
            <%= text_field_tag :card_code, nil, {name: nil, class: "form-control"} %>
          </div>
          <div class="field">
            <%= label_tag :card_month, "Card Expiration" %>
            <%= select_month nil, {add_month_numbers: true}, {name: nil, id: "card_month", class: "select form-control select-block mbl"}%>
            <%= select_year nil, {start_year: Date.today.year, end_year: Date.today.year+10}, {name: nil, id: "card_year", class: "select form-control select-block mbl"}%>
          </span>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">  
        <%= f.input :age_acknowledgement, :required => true, label: false, inline_label: 'I am over 13 years old', input_html: { :data => {:toggle => 'checkbox'} } %>
        <%= f.input :terms_acknowledgement, :required => true, label: false, :inline_label => content_for(:the_links), input_html: { :data => {:toggle => 'checkbox'} } %>
        <%= hidden_field_tag "plan", "{{plan}}" %>
        <%= f.hidden_field :stripe_token %>
        <%= f.button :submit, 'Sign up', :class => 'btn-primary' %>
      </div>
    </div>
<% end %>
  </div>
</div>

<div class="row">
  <div class="col-md-offset-3 col-md-6">
    Note: the alpha version of the app is only available for iPad. <%= link_to "What if I don't have an iPad?", content_noipad_path %>
  </div>
</div>

<script>
//$("select").selectpicker({style: 'btn-info'});
//$("select").selectpicker();
</script>
